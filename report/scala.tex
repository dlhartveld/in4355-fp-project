% string concatenation has horrible performance in a functional scenario.
% use stringbuilder instead, but this breaks side-effects-free coding. Monad?